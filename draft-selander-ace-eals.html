<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Enrollment with Application Layer Security</title>
<meta content="Goeran Selander" name="author">
<meta content="Shahid Raza" name="author">
<meta content="Malisa Vucinic" name="author">
<meta content="Martin Furuhed" name="author">
<meta content="Michael Richardson" name="author">
<meta content="
       This document specifies public key certificate enrollment procedures authenticated with application-layer security protocols suitable for Internet of Things deployments. The protocols leverage existing IoT standards including Constrained Application Protocol (CoAP), Concise Binary Object Representation (CBOR) and the CBOR Object Signing and Encryption (COSE) format. 
    " name="description">
<meta content="xml2rfc 2.37.3" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-selander-ace-eals-latest" name="ietf.draft">
<link href="draft-selander-ace-eals.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --small-font-size: 14.5px;
}
body {
  max-width: 624px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  padding: 1em 0 0.2em;
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1, h2, h3 {
  font-size: 22px;
  line-height: 26px;
}
h4, h5, h6 {
  font-size: 18px;
  line-height: 22px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  line-height: 17px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #eee;
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  font-style: italic;
  margin: 0.3em 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  visibility: hidden;
  user-select: none;
}
a.pilcrow[href] { color: #ddd; }
a.pilcrow[href]:hover { text-decoration: none; }
@media screen {
  :hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 600px) {
  #authors-addresses {
    display: relative;
    padding: 32px 0 0;
    column-count: 2;
    column-gap: 20px;
  }
  #name-authors-addresses {
    position: absolute;
    top: 0px;
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
  }
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #b76427;
  background-color: rgba(249, 232, 105, 0.3);
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: rgba(249, 232, 105, 0.3);
  border-radius: 3px;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 953px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 954px) {
  body {
    padding-right: 380px;
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Enrollment with Application Layer Security</td>
<td class="right">January 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Selander, et al.</td>
<td class="center">Expires 24 July 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-selander-ace-eals-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-01-21" class="published">21 January 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-07-24">24 July 2020</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson AB</div>
</div>
<div class="author">
      <div class="author-name">S. Raza</div>
<div class="org">RISE SICS</div>
</div>
<div class="author">
      <div class="author-name">M. Vucinic</div>
<div class="org">Inria</div>
</div>
<div class="author">
      <div class="author-name">M. Furuhed</div>
<div class="org">Nexus</div>
</div>
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">Sandelman Software Works</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Enrollment with Application Layer Security</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies public key certificate enrollment procedures authenticated with application-layer security protocols suitable for Internet of Things deployments. The protocols leverage existing IoT standards including Constrained Application Protocol (CoAP), Concise Binary Object Representation (CBOR) and the CBOR Object Signing and Encryption (COSE) format.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 24 July 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-cmc-protocol" class="xref">CMC protocol</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-simple-enrollment" class="xref">Simple Enrollment</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-re-enrollment" class="xref">Re-enrollment</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-full-enrollment" class="xref">Full Enrollment</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-compiling-certificate-conte" class="xref">Compiling Certificate Content</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-establishment-of-oscoap-inp" class="xref">Establishment of OSCOAP Input Parameters</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-edhoc" class="xref">EDHOC</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-ace" class="xref">ACE</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-application-to-6tisch" class="xref">Application to 6TiSCH</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-application-to-brski" class="xref">Application to BRSKI</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.10.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.10.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-examples" class="xref">Examples</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Asymmetric cryptography with Public Key Infrastructure (PKI) is a de-facto key exchange and mutual authentication solution in the Internet. Though solutions based on PSK are still state-of-the-art in sensor networks they are not scalable to Internet-connected billions of things. Therefore, most IoT security standards support asymmetric cryptographic protocols. The greatest challenge with asymmetric cryptography and PKI is enrollment, the process of certifying keys. Enrollment is even more challenging in the IoT as things are resource-constrained and traditional enrollment techniques are not compatible with recent IoT security protocols. Without secure enrollment, PKI will not be trustworthy and in turn the cybersecurity of the entire system will be at stake even though the underlying cryptographic cipher suites are most secure.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Security at the application layer provides an attractive option for protecting Internet of Things (IoT) deployments, in particular in constrained environments <span>[<a href="#RFC7228" class="xref">RFC7228</a>]</span> and when using CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>; for example where transport layer security is not sufficient <span>[<a href="#I-D.hartke-core-e2e-security-reqs" class="xref">I-D.hartke-core-e2e-security-reqs</a>]</span>, or where it is beneficial that the security protocol is independent of lower layers, such as when securing CoAP over mixed transport protocols.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Application layer security protocols suitable for constrained devices are in development, including the secure communication protocol OSCOAP <span>[<a href="#I-D.ietf-core-object-security" class="xref">I-D.ietf-core-object-security</a>]</span>. OSCOAP defines an extension to the Constrained Application Protocol (CoAP) providing encryption, integrity and replay protection end-to-end between CoAP client and server based on a shared secret. The shared secret can be established in different ways e.g. using a trusted third party such as in ACE <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, or using a key exchange protocol such as EDHOC <span>[<a href="#I-D.selander-ace-cose-ecdhe" class="xref">I-D.selander-ace-cose-ecdhe</a>]</span>. OSCOAP and EDHOC can leverage other constrained device primitives developed in the IETF: CoAP, CBOR <span>[<a href="#RFC7049" class="xref">RFC7049</a>]</span> and COSE <span>[<a href="#I-D.ietf-cose-msg" class="xref">I-D.ietf-cose-msg</a>]</span>, and makes only a small additional implementation footprint.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Lately, there has been a discussion in several IETF working groups about certificate enrollment protocols suitable for IoT devices, to support the use case of an IoT device joining a new network domain and establishing credentials valid in this domain. This document describes Enrollment with Application Layer Security (EALS), a certificate enrollment protocol based on CMC <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span> and using OSCOAP as a secure channel. This document also describes how ACE and EDHOC can be used for establishing an authenticated and authorized channel.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This work is inspired by the Enrollment over Secure Transport (EST) protocol <span>[<a href="#RFC7030" class="xref">RFC7030</a>]</span>, which also is based on CMC, but EALS is secured on application layer instead of on transport layer.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>. These
words may also appear in this document in lowercase, absent their
normative meanings.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="CMC">
<section id="section-2">
      <h2 id="name-cmc-protocol">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-cmc-protocol" class="section-name selfRef">CMC protocol</a>
      </h2>
<div id="simple-enroll">
<section id="section-2.1">
        <h3 id="name-simple-enrollment">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-simple-enrollment" class="section-name selfRef">Simple Enrollment</a>
        </h3>
<p id="section-2.1-1">This section describes the simple enrollment protocol, which is an embedding of the Simple PKI Request/Response protocol of CMC <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span> in Object Secure CoAP (OSCOAP) <span>[<a href="#I-D.ietf-core-object-security" class="xref">I-D.ietf-core-object-security</a>]</span>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The simple enrollment protocol is a 2-pass protocol between an EALS client (e.g. an IoT device) and an EALS server (a Certification Authority (CA)), see <a href="#fig-simple-enroll" class="xref">Figure 1</a>. The protocol assumes that both EALS client and EALS server implement CoAP and the Object-Security option of CoAP (OSCOAP).<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">OSCOAP assumes the existence of a shared secret between an EALS client and server.
The shared secret may be obtained by running a key agreement algorithm or
by an aid of a trusted third party.
Mutual authentication and authorization occurs during this key agreement stage.
The simple enrollment protocol may also be run directly with a pre-shared key. 
In that case, authentication and authorization of EALS client and server is implicit to the shared key
protecting the /eals resource.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<span id="name-the-simple-enrollment-proto"></span><div id="fig-simple-enroll">
<figure id="figure-1">
          <div class="artwork art-text alignCenter" id="section-2.1-4.1">
<pre>
EALS client                                          EALS server 

  |                                                       | 
  | POST /eals      (Object-Security; Payload: PKCS #10)  |  
  +------------------------------------------------------&gt;|
  |                                                       |          
  |  2.04 Changed   (Object-Security; Payload: PKCS #7)   |
  |&lt;------------------------------------------------------+
  |                                                       |       

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-the-simple-enrollment-proto" class="selfRef">The Simple Enrollment Protocol.</a>
          </figcaption></figure>
</div>
<p id="section-2.1-5">The simple enrollment protocol consists of a CoAP message exchange.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">The EALS client sends a CoAP request:<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-7.1">Method is POST<a href="#section-2.1-7.1" class="pilcrow">¶</a>
</li>
<li id="section-2.1-7.2">Uri-Path is "eals"<a href="#section-2.1-7.2" class="pilcrow">¶</a>
</li>
<li id="section-2.1-7.3">Object-Security option is present<a href="#section-2.1-7.3" class="pilcrow">¶</a>
</li>
<li id="section-2.1-7.4">Payload is the CMC Simple PKI Request <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span> (i.e. a PKCS #10 certification request).<a href="#section-2.1-7.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-2.1-8">If successful, the EALS server sends a CoAP response:<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-9.1">Code is 2.04 (Changed)<a href="#section-2.1-9.1" class="pilcrow">¶</a>
</li>
<li id="section-2.1-9.2">Content-Format is "application/pkcs7-mime" (TBD)<a href="#section-2.1-9.2" class="pilcrow">¶</a>
</li>
<li id="section-2.1-9.3">Object-Security option is present<a href="#section-2.1-9.3" class="pilcrow">¶</a>
</li>
<li id="section-2.1-9.4">Payload is a certs-only CMC Simple PKI Response <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span> (i.e the issued certificate)<a href="#section-2.1-9.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-2.1-10">OSCOAP protects the CoAP message exchange between the endpoints over any transport and via intermediary nodes. The OSCOAP protection requires that a security context is established between client and server. The security context can be derived from a set of Input Parameters (Section 3.3 of <span>[<a href="#I-D.ietf-core-object-security" class="xref">I-D.ietf-core-object-security</a>]</span>), including at least the following:<a href="#section-2.1-10" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-11.1">Master Secret<a href="#section-2.1-11.1" class="pilcrow">¶</a>
</li>
<li id="section-2.1-11.2">Sender ID<a href="#section-2.1-11.2" class="pilcrow">¶</a>
</li>
<li id="section-2.1-11.3">Recipient ID<a href="#section-2.1-11.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-2.1-12">where the Master Secret is a uniformly random byte string, and the Sender ID and Recipient ID are byte strings identifying the endpoints. In <a href="#establish-input-parameters" class="xref">Section 3</a> we give examples of how to the OSCOAP input parameters can be established.<a href="#section-2.1-12" class="pilcrow">¶</a></p>
<p id="section-2.1-13">The server MUST verify that the Master Secret is associated to the Distinguished Name for which the client is requesting a certificate.<a href="#section-2.1-13" class="pilcrow">¶</a></p>
<p id="section-2.1-14">Note 1: The encodings and formats used by CMC may later be updated with other equivalents more adapted to constrained environments.<a href="#section-2.1-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="re-enrollment">
<section id="section-2.2">
        <h3 id="name-re-enrollment">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-re-enrollment" class="section-name selfRef">Re-enrollment</a>
        </h3>
<p id="section-2.2-1">Re-enrollment and re-keying of clients occurs using the same exchange as during 
the simple enrollment protocol. Re-enrollment request follows the same format 
as during the simple enrollment. In case of success, re-enrollment response 
contains certs-only CMC Simple PKI Response, as in the case of simple enrollment
with content-format set to "application/pkcs7-mime".<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">TBD. Requirements on parsing PKCS messages and X.509 certificates<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">TBD. Error handling with CoAP error codes<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">TBD. Server-side key generation<a href="#section-2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="full-enroll">
<section id="section-2.3">
        <h3 id="name-full-enrollment">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-full-enrollment" class="section-name selfRef">Full Enrollment</a>
        </h3>
<p id="section-2.3-1">It is straightforward to extend the simple enrollment to the CMC Full PKI Request/Response protocol.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">In this case, to authorize the PKCS#10 request to the CA, it is enveloped in a CMC message and signed with a pre-installed device private key and certificate by the device itself.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">The public key in the device certificate acts as a unique identifier of the device. By trusting the CA issuing the pre-installed certificate, the enrolment CA can acknowledge the signed request. The trusted factory CA will also ensure the origin of the device.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">An alternative to authorize the PKCS#10 request to the CA, is to use a security gateway that can envelope the request in a CMC message using a certificate trusted by the CA.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<p id="section-2.3-5">The details are FFS.<a href="#section-2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="establish-content">
<section id="section-2.4">
        <h3 id="name-compiling-certificate-conte">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-compiling-certificate-conte" class="section-name selfRef">Compiling Certificate Content</a>
        </h3>
<p id="section-2.4-1">A CA have several means of compiling certificate content during issuance. The subject Distinguished Name (DN) information for the certificate may be based on the content of the request alone.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">Alternatively, complementary data can be added to the request by the CA from an external source trusted by the CA, or taken from records of pre-registered information on end-entities that is stored in the CA system and which can be uniquely matched to the data in the request. Due to the constrained device capabilities the amount of subject DN data in a request may be very limited. The method of adding complementary data for the certificate can be a choice of the CA, assuming the source of complementary data can be provided in a trustworthy way.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">With the option to add complementary data to a certificate request, the end-entity provided data can be diminished by e.g. submitting only the public key in the PKCS#10 content. The public key can be used to match the device to pre-registered data or for retrieval of subject data from other sources.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="establish-input-parameters">
<section id="section-3">
      <h2 id="name-establishment-of-oscoap-inp">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-establishment-of-oscoap-inp" class="section-name selfRef">Establishment of OSCOAP Input Parameters</a>
      </h2>
<p id="section-3-1">In this section we present two application layer protocols for establishing OSCOAP input parameters (Section 3.3 of <span>[<a href="#I-D.ietf-core-object-security" class="xref">I-D.ietf-core-object-security</a>]</span>), in particular the OSCOAP master secret.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="sec-edhoc">
<section id="section-3.1">
        <h3 id="name-edhoc">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-edhoc" class="section-name selfRef">EDHOC</a>
        </h3>
<p id="section-3.1-1">EDHOC <span>[<a href="#I-D.selander-ace-cose-ecdhe" class="xref">I-D.selander-ace-cose-ecdhe</a>]</span> is a key establishment protocol, corresponding to the handshake protocol of TLS, encoded with CBOR and using COSE that may be transported with e.g. CoAP. EDHOC provides mutual authentication of client and server and establishes a shared secret with forward secrecy which may be used as OSCOAP master secret in the CMC protocol (<a href="#CMC" class="xref">Section 2</a>).<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The asymmetric keys authenticated version of EDHOC is described in section 4 of <span>[<a href="#I-D.selander-ace-cose-ecdhe" class="xref">I-D.selander-ace-cose-ecdhe</a>]</span>,
a simplified version of the protocol is shown in <a href="#fig-EDHOC" class="xref">Figure 2</a>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<span id="name-edhoc-with-asymmetric-key-a"></span><div id="fig-EDHOC">
<figure id="figure-2">
          <div class="artwork art-text alignCenter" id="section-3.1-3.1">
<pre>
Party U                                                    Party V
   |                   S_U, N_U, E_U, EXT_1                   |
   +---------------------------------------------------------&gt;|
   |                                                          |
   |  S_U, S_V, N_V, E_V, AEAD(EXT_2, ID_V, Sig(V; E_U, E_V)) |
   |&lt;---------------------------------------------------------+
   |                                                          |
   |        S_V, AEAD(EXT_3, ID_U, Sig(U; E_V, E_U))          |
   +---------------------------------------------------------&gt;|
   |                                                          |


</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-edhoc-with-asymmetric-key-a" class="selfRef">EDHOC with asymmetric key authentication (simplified). S = session identifer, N = nonce, E = ephemeral public key, ID = identifier, and EXT = application defined extension.</a>
          </figcaption></figure>
</div>
<p id="section-3.1-4">The session identifiers S_U and S_V may be used as OSCOAP input parameters Sender ID and Recipient ID of party U, and v.v. as described in Appendix B2 of <span>[<a href="#I-D.selander-ace-cose-ecdhe" class="xref">I-D.selander-ace-cose-ecdhe</a>]</span>.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5"><a href="#fig-EDHOC-EALS" class="xref">Figure 3</a> shows an example of using the EDHOC protocol to establish a mutually authenticated and authorized channel for the simple enrolment protocol. In this case the EALS server is EDHOC client (the mapping with interchanged roles is straightforward and left FFS). This setting has the following properties:<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal" id="section-3.1-6">
          <li id="section-3.1-6.1">The EALS server initiates the EDHOC protocol. This allows the EALS server to orchestrate many concurrent enrollments, and control the associated network load.<a href="#section-3.1-6.1" class="pilcrow">¶</a>
</li>
<li id="section-3.1-6.2">The EALS client is authenticated first (EDHOC message_2). This allows the EALS server to authenticate the EALS client, and with this information to authorize the EALS client before completing the EDHOC protocol. The EALS server may in this case also relay authorizaton information about the EALS client, such as an ownership voucher, to the client in EDHOC extension EXT_3.<a href="#section-3.1-6.2" class="pilcrow">¶</a>
</li>
</ol>
<span id="name-eals-extension-of-edhoc"></span><div id="fig-EDHOC-EALS">
<figure id="figure-3">
          <div class="artwork art-text alignCenter" id="section-3.1-7.1">
<pre>
 EALS                                     EALS 
client                                   server

  |                                        |                       
  |                                        |                       
  +---------------------------------------&gt;|                       
  |                                        |                       
  |             EDHOC message_1            |                       
  |&lt;---------------------------------------+                       
  |                                        |                       
  |            EDHOC message_2             |                       
  +---------------------------------------&gt;|    Third party           
  |                                        | &lt; - - - - - - - - &gt;            
  |  EDHOC message_3 (EXT_3 = Authz info)  |    authorization
  |&lt;---------------------------------------+                       
  |                                        |                        

</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-eals-extension-of-edhoc" class="selfRef">EALS extension of EDHOC.</a>
          </figcaption></figure>
</div>
<p id="section-3.1-8">Appendix B1 of <span>[<a href="#I-D.selander-ace-cose-ecdhe" class="xref">I-D.selander-ace-cose-ecdhe</a>]</span> shows how to embed EDHOC in a CoAP message exchange, a similar embedding can be applied here.<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">TBD Detail the protocol<a href="#section-3.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ace">
<section id="section-3.2">
        <h3 id="name-ace">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-ace" class="section-name selfRef">ACE</a>
        </h3>
<p id="section-3.2-1">The ACE protocol framework <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> is an adaptation of OAuth 2.0 to IoT deployments. ACE describes different message flows for a Client to get authorized access to a Resource Server (RS) by leveraging an Authorization Server (AS).<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The Token Introspection flow (Section 7 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>) allows an RS to access authorization information relating to a client provided Access Token. If the access token is valid, the RS obtains information about the access rights and a symmetric key used by the client, and also a Client Token containing the same shared key protected for the legitimate client (Section 7.4 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, <a href="#ACE-introspect" class="xref">Figure 4</a>).<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">This message flow assumes that the Client and AS, as well as the RS and AS, has or can establish a mutually authenticated secure channel such that:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-4.1">The AS can encrypt the symmetric key for the Client in the Client Token, and the Client can verify the Client Token is issued by the AS;<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
<li id="section-3.2-4.2">The RS and AS can exchange encrypted, integrity and replay protected introspection messages. In this case, the establishment of the secure channel can take place immediately before introspection, triggered by the RS receiveing the Access Token.<a href="#section-3.2-4.2" class="pilcrow">¶</a>
</li>
</ul>
<span id="name-ace-token-introspection-wit"></span><div id="ACE-introspect">
<figure id="figure-4">
          <div class="artwork art-text alignCenter" id="section-3.2-5.1">
<pre>
                     Resource       Authorization
    Client            Server           Server
       |                |                |
       |                |                |
       +---------------&gt;|                |
       |  POST          |                |
       |  Access Token  |                |
       |                |&lt;- - - - - - - &gt;|
       |                |(Authentication)|
       |                |                |
       |                +---------------&gt;|
       |                | Introspection  |
       |                |    Request     |
       |                |                |
       |                +&lt;---------------+
       |                | Introspection  |
       |                |   Response     |
       |                | + Client Token |
       |&lt;---------------+                |
       |  2.01 Created  |                |
       | + Client Token |


</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-ace-token-introspection-wit" class="selfRef">ACE Token Introspection with Client Token.</a>
          </figcaption></figure>
</div>
<p id="section-3.2-6">By mapping the EALS client and server to the ACE client and resource server, respectively, this application of ACE enables the authorization of EALS client and establishment of a shared key, which can be used as master secret with OSCOAP in the CMC protocol (<a href="#CMC" class="xref">Section 2</a>). In this case, the access token contains access rights to /eals, but is not (yet) bound to a particular resource server. The access token could be pre-provisioned to the client, e.g. during manufacture. Information about binding to resource server comes with the introspection response.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">Section 2 of <span>[<a href="#I-D.seitz-ace-oscoap-profile" class="xref">I-D.seitz-ace-oscoap-profile</a>]</span> defines additional common header parameters for COSE_Key structure that are used to carry OSCOAP input parameters Sender and Recipient ID. The OSCOAP master secret is transported as part of the symmetric COSE_Key object. This document uses the same construct: COSE_Key object with OSCOAP input parameters present is transported as part of the Introspection Response and in the Client Token.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">For the benefit of the client authorizing the enrollment, this document defines an additional common parameter for the Client Token called Voucher, extending the definition in Section 7.4 of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>:<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-9">
<pre>
voucher
    OPTIONAL. Contains authorization information about the server, 
    e.g. ownership voucher. The encoding is TBD. 
</pre><a href="#section-3.2-9" class="pilcrow">¶</a>
</div>
<span id="name-cbor-mapping-of-parameters-"></span><div id="ACE-cbor-mapping-voucher">
<figure id="figure-5">
          <div class="artwork art-text alignCenter" id="section-3.2-10.1">
<pre>
.-------------------+----------+-----------------.
| Parameter name    | CBOR Key | Major Type      |
|-------------------+----------+-----------------|
| voucher           | TBD      | 2 (byte string) |
'-------------------+----------+-----------------'
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-cbor-mapping-of-parameters-" class="selfRef">CBOR mapping of parameters extending the client token.</a>
          </figcaption></figure>
</div>
<p id="section-3.2-11">Additionally, the certificate attributes presented by the Client in the enrolment request (<a href="#CMC" class="xref">Section 2</a>) may be carried in the Client Token. The encoding is TBD.<a href="#section-3.2-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="application-to-6tisch">
<section id="section-4">
      <h2 id="name-application-to-6tisch">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-application-to-6tisch" class="section-name selfRef">Application to 6TiSCH</a>
      </h2>
<p id="section-4-1">One candidate embedding of EALS into a bootstrapping architecture is as described in <span>[<a href="#I-D.ietf-6tisch-minimal-security" class="xref">I-D.ietf-6tisch-minimal-security</a>]</span>. The new device (a.k.a. Pledge) requests to be admitted into the network managed by the Join Registrar/Coordinator. The Pledge maps to an EALS/CoAP client, and the Join Registrar/Coordinator maps to an EALS/CoAP server.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">When a pledge first joins a constrained network, it typically does not have IPv6 connectivity to reach the Join Registrar/Coordinator. For that reason, pledge communicates with the Join Proxy, a one hop neighbor of the pledge.  Join Proxy statelessly relays the exchanges between the pledge and the Join Registrar/Coordinator.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">As in the model of <span>[<a href="#I-D.ietf-6tisch-minimal-security" class="xref">I-D.ietf-6tisch-minimal-security</a>]</span>, the Join Proxy plays the role of a CoAP proxy.
Default CoAP proxy, however, keeps state information in order to relay the response back to the originating client, in this case the pledge. To mitigate Denial of Service attacks at the Join Proxy, <span>[<a href="#I-D.ietf-6tisch-minimal-security" class="xref">I-D.ietf-6tisch-minimal-security</a>]</span> mandates the use of a new CoAP option, Stateless-Proxy option, that allows the Join Proxy to operate without keeping per-client state.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The use of EDHOC as described in <a href="#sec-edhoc" class="xref">Section 3.1</a> enables mutual authentication and authorization of Pledge and Join Registrar/Coordinator, and supports the use of the Stateless-Proxy option in order to provide the CoAP Proxy functionality described in this section.<a href="#section-4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="application-to-brski">
<section id="section-5">
      <h2 id="name-application-to-brski">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-application-to-brski" class="section-name selfRef">Application to BRSKI</a>
      </h2>
<p id="section-5-1">Another application of EALS is to the BRSKI <span>[<a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">I-D.ietf-anima-bootstrapping-keyinfra</a>]</span> problem statement. BRSKI specifies an automated bootstrapping of a remote secure key infrastructure (BRSKI) using vendor installed X.509 certificate, in combination with a vendor authorized service on the Internet. BRSKI is referencing Enrolment over Secure Transport (EST) <span>[<a href="#RFC7030" class="xref">RFC7030</a>]</span> to enable zero-touch joining of a device in a network domain. The same approach can be applied using EDHOC instead of EST, as is outlined in this document.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The audit/ownership vouchers specified in <span>[<a href="#I-D.ietf-anima-bootstrapping-keyinfra" class="xref">I-D.ietf-anima-bootstrapping-keyinfra</a>]</span> are carried as part of EDHOC application-defined extensions, as described in <a href="#sec-edhoc" class="xref">Section 3.1</a>. Nonces of the EDHOC protocol can be used for freshness also of the authorization step.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The limitations of applicability to energy-constrained devices due to credential size applies also to this document, and further work is needed to specify certificate formats relevant to constrained devices.
Having said that, one rationale for this document is a more optimized message exchange, and potentially also code footprint, which is favorable in low-power deployments.<a href="#section-5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cons">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
    </h2>
</section>
</div>
<div id="privacy-considerations">
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
    </h2>
</section>
</div>
<div id="iana">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
    </h2>
</section>
</div>
<div id="acknowledgments">
<section id="section-9">
      <h2 id="name-acknowledgments">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-9-1">The authors wants to thank the participants of the 6tisch security design team for discussions and input contributing to this document.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-oauth-authz">[I-D.ietf-ace-oauth-authz]</dt>
<dd>
<span class="refAuthor">Seitz, L.</span><span class="refAuthor">, Selander, G.</span><span class="refAuthor">, Wahlstroem, E.</span><span class="refAuthor">, Erdtman, S.</span><span class="refAuthor">, and H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments (ACE) using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-authz-31</span>, <time datetime="2020-01-18">18 January 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ace-oauth-authz-31.txt">http://www.ietf.org/internet-drafts/draft-ietf-ace-oauth-authz-31.txt</a>&gt;</span>. </dd>
<dt id="I-D.ietf-core-object-security">[I-D.ietf-core-object-security]</dt>
<dd>
<span class="refAuthor">Selander, G.</span><span class="refAuthor">, Mattsson, J.</span><span class="refAuthor">, Palombini, F.</span><span class="refAuthor">, and L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-object-security-16</span>, <time datetime="2019-03-06">6 March 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-core-object-security-16.txt">http://www.ietf.org/internet-drafts/draft-ietf-core-object-security-16.txt</a>&gt;</span>. </dd>
<dt id="I-D.ietf-cose-msg">[I-D.ietf-cose-msg]</dt>
<dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-msg-24</span>, <time datetime="2016-11-22">22 November 2016</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-cose-msg-24.txt">http://www.ietf.org/internet-drafts/draft-ietf-cose-msg-24.txt</a>&gt;</span>. </dd>
<dt id="I-D.selander-ace-cose-ecdhe">[I-D.selander-ace-cose-ecdhe]</dt>
<dd>
<span class="refAuthor">Selander, G.</span><span class="refAuthor">, Mattsson, J.</span><span class="refAuthor">, and F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-selander-ace-cose-ecdhe-14</span>, <time datetime="2019-09-11">11 September 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-selander-ace-cose-ecdhe-14.txt">http://www.ietf.org/internet-drafts/draft-selander-ace-cose-ecdhe-14.txt</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC7049">[RFC7049]</dt>
<dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor"> and P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <span class="seriesInfo">DOI 10.17487/RFC7049</span>, <time datetime="2013-10">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7049">https://www.rfc-editor.org/info/rfc7049</a>&gt;</span>. </dd>
<dt id="RFC7252">[RFC7252]</dt>
<dd>
<span class="refAuthor">Shelby, Z.</span><span class="refAuthor">, Hartke, K.</span><span class="refAuthor">, and C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.hartke-core-e2e-security-reqs">[I-D.hartke-core-e2e-security-reqs]</dt>
<dd>
<span class="refAuthor">Selander, G.</span><span class="refAuthor">, Palombini, F.</span><span class="refAuthor">, and K. Hartke</span>, <span class="refTitle">"Requirements for CoAP End-To-End Security"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hartke-core-e2e-security-reqs-03</span>, <time datetime="2017-07-29">29 July 2017</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-hartke-core-e2e-security-reqs-03.txt">http://www.ietf.org/internet-drafts/draft-hartke-core-e2e-security-reqs-03.txt</a>&gt;</span>. </dd>
<dt id="I-D.ietf-6tisch-minimal-security">[I-D.ietf-6tisch-minimal-security]</dt>
<dd>
<span class="refAuthor">Vucinic, M.</span><span class="refAuthor">, Simon, J.</span><span class="refAuthor">, Pister, K.</span><span class="refAuthor">, and M. Richardson</span>, <span class="refTitle">"Constrained Join Protocol (CoJP) for 6TiSCH"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-6tisch-minimal-security-15</span>, <time datetime="2019-12-10">10 December 2019</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-6tisch-minimal-security-15.txt">http://www.ietf.org/internet-drafts/draft-ietf-6tisch-minimal-security-15.txt</a>&gt;</span>. </dd>
<dt id="I-D.ietf-anima-bootstrapping-keyinfra">[I-D.ietf-anima-bootstrapping-keyinfra]</dt>
<dd>
<span class="refAuthor">Pritikin, M.</span><span class="refAuthor">, Richardson, M.</span><span class="refAuthor">, Eckert, T.</span><span class="refAuthor">, Behringer, M.</span><span class="refAuthor">, and K. Watsen</span>, <span class="refTitle">"Bootstrapping Remote Secure Key Infrastructures (BRSKI)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-bootstrapping-keyinfra-34</span>, <time datetime="2020-01-03">3 January 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-anima-bootstrapping-keyinfra-34.txt">http://www.ietf.org/internet-drafts/draft-ietf-anima-bootstrapping-keyinfra-34.txt</a>&gt;</span>. </dd>
<dt id="I-D.seitz-ace-oscoap-profile">[I-D.seitz-ace-oscoap-profile]</dt>
<dd>
<span class="refAuthor">Seitz, L.</span><span class="refAuthor">, Palombini, F.</span><span class="refAuthor">, and M. Gunnarsson</span>, <span class="refTitle">"OSCORE profile of the Authentication and Authorization for Constrained Environments Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-seitz-ace-oscoap-profile-06</span>, <time datetime="2017-10-26">26 October 2017</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-seitz-ace-oscoap-profile-06.txt">http://www.ietf.org/internet-drafts/draft-seitz-ace-oscoap-profile-06.txt</a>&gt;</span>. </dd>
<dt id="RFC5272">[RFC5272]</dt>
<dd>
<span class="refAuthor">Schaad, J.</span><span class="refAuthor"> and M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC)"</span>, <span class="seriesInfo">RFC 5272</span>, <span class="seriesInfo">DOI 10.17487/RFC5272</span>, <time datetime="2008-06">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5272">https://www.rfc-editor.org/info/rfc5272</a>&gt;</span>. </dd>
<dt id="RFC7030">[RFC7030]</dt>
<dd>
<span class="refAuthor">Pritikin, M., Ed.</span><span class="refAuthor">, Yee, P., Ed.</span><span class="refAuthor">, and D. Harkins, Ed.</span>, <span class="refTitle">"Enrollment over Secure Transport"</span>, <span class="seriesInfo">RFC 7030</span>, <span class="seriesInfo">DOI 10.17487/RFC7030</span>, <time datetime="2013-10">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7030">https://www.rfc-editor.org/info/rfc7030</a>&gt;</span>. </dd>
<dt id="RFC7228">[RFC7228]</dt>
<dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor">, Ersue, M.</span><span class="refAuthor">, and A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
</dl>
</section>
</section>
<div id="examples">
<section id="section-appendix.a">
      <h2 id="name-examples">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
    </h2>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Goeran Selander</span></div>
<div dir="auto" class="left"><span class="org">Ericsson AB</span></div>
<div dir="auto" class="left"><span class="street-address">Farogatan 6</span></div>
<div dir="auto" class="left">
<span class="postal-code">16480 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goran.selander@ericsson.com" class="email">goran.selander@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Shahid Raza</span></div>
<div dir="auto" class="left"><span class="org">RISE SICS</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">
<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:shahid@sics.se" class="email">shahid@sics.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Malisa Vucinic</span></div>
<div dir="auto" class="left"><span class="org">Inria</span></div>
<div dir="auto" class="left"><span class="street-address">2 Rue Simone Iff</span></div>
<div dir="auto" class="left">
<span class="postal-code">75012</span> <span class="locality">Paris</span>
</div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:malisa.vucinic@inria.fr" class="email">malisa.vucinic@inria.fr</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Martin Furuhed</span></div>
<div dir="auto" class="left"><span class="org">Nexus</span></div>
<div dir="auto" class="left"><span class="street-address">Telefonv. 26</span></div>
<div dir="auto" class="left">
<span class="postal-code">12626</span> <span class="locality">Stockholm</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:martin.furuhed@nexusgroup.com" class="email">martin.furuhed@nexusgroup.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Richardson</span></div>
<div dir="auto" class="left"><span class="org">Sandelman Software Works</span></div>
<div dir="auto" class="left"><span class="street-address">470 Dawson Avenue</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa, ON</span>  <span class="postal-code">K1Z5V7</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mcr+ietf@sandelman.ca" class="email">mcr+ietf@sandelman.ca</a>
</div>
</address>
</section>
</div>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>
</body>
</html>
